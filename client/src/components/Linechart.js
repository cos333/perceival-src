import './Chart.css';

import React, { Component } from 'react';

import Dropdown from './Dropdown';
import DropdownThree from './DropdownThree';
import Line from './Line';

class Linechart extends Component {
  constructor(props) {
    super(props);
    this.state = {
      response: [
        { name: 'Number of Clicks', key: 'numclicks' },
        { name: 'Cents Spent', key: 'centsspent' },
        { name: 'Seconds Spent', key: 'secondsspent' }
      ],
      segment: [
        { name: 'Age', key: 'age' }, { name: 'Country', key: 'country' },
        { name: 'Gender', key: 'gender' }, { name: 'Language', key: 'language' }
      ],
      display: [
        { name: 'Mean', key: 'mean' },
        { name: 'Average', key: 'average' }
      ],
      url: '',
      currentResponse: 'numclicks',
      currentSegment: 'age',
      dataset: [
        {
          'y': [
            84.685, 82.2302, 74.8333, 67.0522, 69.9355, 60.063,
            58.3254, 52.8537, 49.9076, 45.3233, 43.5042, 38.8651,
            35.5366, 28.6142, 28.5484, 25.7917, 22.7398, 21.4844,
            19.6694, 16.0917, 15.3893, 16.6529, 13.3051, 12.8548,
            12.1864, 11.9141, 10.9597, 10.9748, 10.3689, 10.281
          ],
          'x': [
            '2004-05-01', '2004-05-02', '2004-05-03', '2004-05-04',
            '2004-05-05', '2004-05-06', '2004-05-07', '2004-05-08',
            '2004-05-09', '2004-05-10', '2004-05-11', '2004-05-12',
            '2004-05-13', '2004-05-14', '2004-05-15', '2004-05-16',
            '2004-05-17', '2004-05-18', '2004-05-19', '2004-05-20',
            '2004-05-21', '2004-05-22', '2004-05-23', '2004-05-24',
            '2004-05-25', '2004-05-26', '2004-05-27', '2004-05-28',
            '2004-05-29', '2004-05-30'
          ],
          'label': '18-24'
        },
        {
          'y': [
            37.3799, 41.1144, 33.7435, 31.0562, 31.5517, 26.6709,
            23.3304, 20.2408, 20.5238, 17.8667, 16.3933, 17.7511,
            15.0348, 14.0506, 13.3625, 11.6926, 11.9504, 11.3699,
            10.2377, 10.9261, 10.2769, 10.1087, 10.1715, 10.1709,
            10.2876, 10.0, 10.0544, 10.0325, 10.0, 10.0171
          ],
          'x': [
            '2004-05-01', '2004-05-02', '2004-05-03', '2004-05-04',
            '2004-05-05', '2004-05-06', '2004-05-07', '2004-05-08',
            '2004-05-09', '2004-05-10', '2004-05-11', '2004-05-12',
            '2004-05-13', '2004-05-14', '2004-05-15', '2004-05-16',
            '2004-05-17', '2004-05-18', '2004-05-19', '2004-05-20',
            '2004-05-21', '2004-05-22', '2004-05-23', '2004-05-24',
            '2004-05-25', '2004-05-26', '2004-05-27', '2004-05-28',
            '2004-05-29', '2004-05-30'
          ],
          'label': '25-34'
        },
        {
          'y': [
            66.7593, 63.2982, 62.1636, 42.3158, 47.8519, 45.8421,
            41.7759, 38.0455, 30.5185, 26.7455, 27.4035, 28.5172,
            22.5873, 19.3167, 20.8393, 17.3621, 15.3273, 16.5439,
            14.1636, 14.3396, 15.5614, 10.7368, 10.36, 10.9492,
            11.5614, 10.6271, 10.5185, 10.2143, 10.6667, 10.0
          ],
          'x': [
            '2004-05-01', '2004-05-02', '2004-05-03', '2004-05-04',
            '2004-05-05', '2004-05-06', '2004-05-07', '2004-05-08',
            '2004-05-09', '2004-05-10', '2004-05-11', '2004-05-12',
            '2004-05-13', '2004-05-14', '2004-05-15', '2004-05-16',
            '2004-05-17', '2004-05-18', '2004-05-19', '2004-05-20',
            '2004-05-21', '2004-05-22', '2004-05-23', '2004-05-24',
            '2004-05-25', '2004-05-26', '2004-05-27', '2004-05-28',
            '2004-05-29', '2004-05-30'
          ],
          'label': '35-44'
        }
      ]
    };

    this.updateResponse = this.updateResponse.bind(this);
    this.updateSegment = this.updateSegment.bind(this);
    this.handleClick = this.handleClick.bind(this);
  }

  componentDidMount() {
  };

  handleClick(key) {
    console.log('handleClick Called. Key is ' + key);
    var responses = ['numclicks', 'centsspent', 'secondsspent'];
    var segments = ['age', 'country', 'gender', 'language'];

    if (responses.includes(key)) {
      this.updateResponse(key);
    } else if (segments.includes(key)) {
      this.updateSegment(key);
    } else {
      console.log('No such key');
    }
  }


  updateResponse(response) {
    console.log('updateResponse called');
    var newData;

    var numclicks = [
      {
        'y': [
          84.685, 82.2302, 74.8333, 67.0522, 69.9355, 60.063,
          58.3254, 52.8537, 49.9076, 45.3233, 43.5042, 38.8651,
          35.5366, 28.6142, 28.5484, 25.7917, 22.7398, 21.4844,
          19.6694, 16.0917, 15.3893, 16.6529, 13.3051, 12.8548,
          12.1864, 11.9141, 10.9597, 10.9748, 10.3689, 10.281
        ],
        'x': [
          '2004-05-01', '2004-05-02', '2004-05-03', '2004-05-04',
          '2004-05-05', '2004-05-06', '2004-05-07', '2004-05-08',
          '2004-05-09', '2004-05-10', '2004-05-11', '2004-05-12',
          '2004-05-13', '2004-05-14', '2004-05-15', '2004-05-16',
          '2004-05-17', '2004-05-18', '2004-05-19', '2004-05-20',
          '2004-05-21', '2004-05-22', '2004-05-23', '2004-05-24',
          '2004-05-25', '2004-05-26', '2004-05-27', '2004-05-28',
          '2004-05-29', '2004-05-30'
        ],
        'label': '18-24'
      },
      {
        'y': [
          37.3799, 41.1144, 33.7435, 31.0562, 31.5517, 26.6709,
          23.3304, 20.2408, 20.5238, 17.8667, 16.3933, 17.7511,
          15.0348, 14.0506, 13.3625, 11.6926, 11.9504, 11.3699,
          10.2377, 10.9261, 10.2769, 10.1087, 10.1715, 10.1709,
          10.2876, 10.0, 10.0544, 10.0325, 10.0, 10.0171
        ],
        'x': [
          '2004-05-01', '2004-05-02', '2004-05-03', '2004-05-04',
          '2004-05-05', '2004-05-06', '2004-05-07', '2004-05-08',
          '2004-05-09', '2004-05-10', '2004-05-11', '2004-05-12',
          '2004-05-13', '2004-05-14', '2004-05-15', '2004-05-16',
          '2004-05-17', '2004-05-18', '2004-05-19', '2004-05-20',
          '2004-05-21', '2004-05-22', '2004-05-23', '2004-05-24',
          '2004-05-25', '2004-05-26', '2004-05-27', '2004-05-28',
          '2004-05-29', '2004-05-30'
        ],
        'label': '25-34'
      },
      {
        'y': [
          66.7593, 63.2982, 62.1636, 42.3158, 47.8519, 45.8421,
          41.7759, 38.0455, 30.5185, 26.7455, 27.4035, 28.5172,
          22.5873, 19.3167, 20.8393, 17.3621, 15.3273, 16.5439,
          14.1636, 14.3396, 15.5614, 10.7368, 10.36, 10.9492,
          11.5614, 10.6271, 10.5185, 10.2143, 10.6667, 10.0
        ],
        'x': [
          '2004-05-01', '2004-05-02', '2004-05-03', '2004-05-04',
          '2004-05-05', '2004-05-06', '2004-05-07', '2004-05-08',
          '2004-05-09', '2004-05-10', '2004-05-11', '2004-05-12',
          '2004-05-13', '2004-05-14', '2004-05-15', '2004-05-16',
          '2004-05-17', '2004-05-18', '2004-05-19', '2004-05-20',
          '2004-05-21', '2004-05-22', '2004-05-23', '2004-05-24',
          '2004-05-25', '2004-05-26', '2004-05-27', '2004-05-28',
          '2004-05-29', '2004-05-30'
        ],
        'label': '35-44'
      }
    ];
    var centsspent = [{
      "y": [0.2598, 0.2619, 0.2302, 0.1866, 0.1694, 0.2441, 0.2143, 0.2195, 0.2185, 0.2857, 0.3193, 0.2302, 0.2114, 0.2756, 0.1452, 0.3, 0.3008, 0.2188, 0.2984, 0.1833, 0.1756, 0.2231, 0.2288, 0.2177, 0.2119, 0.2734, 0.3065, 0.1681, 0.3115, 0.157],
      "x": ["2004-05-01", "2004-05-02", "2004-05-03", "2004-05-04", "2004-05-05", "2004-05-06", "2004-05-07", "2004-05-08", "2004-05-09", "2004-05-10", "2004-05-11", "2004-05-12", "2004-05-13", "2004-05-14", "2004-05-15", "2004-05-16", "2004-05-17", "2004-05-18", "2004-05-19", "2004-05-20", "2004-05-21", "2004-05-22", "2004-05-23", "2004-05-24", "2004-05-25", "2004-05-26", "2004-05-27", "2004-05-28", "2004-05-29", "2004-05-30"],
      "label": "18-24"
    }, {
      "y": [0.7118, 0.7161, 0.6348, 0.8313, 0.7284, 0.7511, 0.6304, 0.7388, 0.6147, 0.6458, 0.7322, 0.7768, 0.7391, 0.6962, 0.7542, 0.5671, 0.7273, 0.7439, 0.709, 0.7783, 0.6694, 0.6783, 0.7071, 0.641, 0.691, 0.7095, 0.7238, 0.687, 0.6407, 0.7479],
      "x": ["2004-05-01", "2004-05-02", "2004-05-03", "2004-05-04", "2004-05-05", "2004-05-06", "2004-05-07", "2004-05-08", "2004-05-09", "2004-05-10", "2004-05-11", "2004-05-12", "2004-05-13", "2004-05-14", "2004-05-15", "2004-05-16", "2004-05-17", "2004-05-18", "2004-05-19", "2004-05-20", "2004-05-21", "2004-05-22", "2004-05-23", "2004-05-24", "2004-05-25", "2004-05-26", "2004-05-27", "2004-05-28", "2004-05-29", "2004-05-30"],
      "label": "25-34"
    }, {
      "y": [1.9444, 1.4737, 1.5636, 1.8421, 1.5741, 1.3333, 1.1034, 1.7727, 1.537, 1.8909, 1.5614, 1.6379, 1.619, 1.4167, 1.8214, 1.8966, 1.6909, 1.5614, 1.4727, 1.4906, 1.614, 1.4561, 1.82, 1.5593, 1.4386, 1.5254, 1.4259, 1.5714, 1.3519, 1.4182],
      "x": ["2004-05-01", "2004-05-02", "2004-05-03", "2004-05-04", "2004-05-05", "2004-05-06", "2004-05-07", "2004-05-08", "2004-05-09", "2004-05-10", "2004-05-11", "2004-05-12", "2004-05-13", "2004-05-14", "2004-05-15", "2004-05-16", "2004-05-17", "2004-05-18", "2004-05-19", "2004-05-20", "2004-05-21", "2004-05-22", "2004-05-23", "2004-05-24", "2004-05-25", "2004-05-26", "2004-05-27", "2004-05-28", "2004-05-29", "2004-05-30"],
      "label": "35-44"
    }];

    var secondsspent = [
      {
        "y": [84.685, 82.2302, 74.8333, 67.0522, 69.9355, 60.063, 58.3254, 52.8537, 49.9076, 45.3233, 43.5042, 38.8651, 35.5366, 28.6142, 28.5484, 25.7917, 22.7398, 21.4844, 19.6694, 16.0917, 15.3893, 16.6529, 13.3051, 12.8548, 12.1864, 11.9141, 10.9597, 10.9748, 10.3689, 10.281],
        "x": ["2004-05-01", "2004-05-02", "2004-05-03", "2004-05-04", "2004-05-05", "2004-05-06", "2004-05-07", "2004-05-08", "2004-05-09", "2004-05-10", "2004-05-11", "2004-05-12", "2004-05-13", "2004-05-14", "2004-05-15", "2004-05-16", "2004-05-17", "2004-05-18", "2004-05-19", "2004-05-20", "2004-05-21", "2004-05-22", "2004-05-23", "2004-05-24", "2004-05-25", "2004-05-26", "2004-05-27", "2004-05-28", "2004-05-29", "2004-05-30"],
        "label": "18-24"
      }, {
        "y": [37.3799, 41.1144, 33.7435, 31.0562, 31.5517, 26.6709, 23.3304, 20.2408, 20.5238, 17.8667, 16.3933, 17.7511, 15.0348, 14.0506, 13.3625, 11.6926, 11.9504, 11.3699, 10.2377, 10.9261, 10.2769, 10.1087, 10.1715, 10.1709, 10.2876, 10.0, 10.0544, 10.0325, 10.0, 10.0171],
        "x": ["2004-05-01", "2004-05-02", "2004-05-03", "2004-05-04", "2004-05-05", "2004-05-06", "2004-05-07", "2004-05-08", "2004-05-09", "2004-05-10", "2004-05-11", "2004-05-12", "2004-05-13", "2004-05-14", "2004-05-15", "2004-05-16", "2004-05-17", "2004-05-18", "2004-05-19", "2004-05-20", "2004-05-21", "2004-05-22", "2004-05-23", "2004-05-24", "2004-05-25", "2004-05-26", "2004-05-27", "2004-05-28", "2004-05-29", "2004-05-30"],
        "label": "25-34"
      }, {
        "y": [66.7593, 63.2982, 62.1636, 42.3158, 47.8519, 45.8421, 41.7759, 38.0455, 30.5185, 26.7455, 27.4035, 28.5172, 22.5873, 19.3167, 20.8393, 17.3621, 15.3273, 16.5439, 14.1636, 14.3396, 15.5614, 10.7368, 10.36, 10.9492, 11.5614, 10.6271, 10.5185, 10.2143, 10.6667, 10.0],
        "x": ["2004-05-01", "2004-05-02", "2004-05-03", "2004-05-04", "2004-05-05", "2004-05-06", "2004-05-07", "2004-05-08", "2004-05-09", "2004-05-10", "2004-05-11", "2004-05-12", "2004-05-13", "2004-05-14", "2004-05-15", "2004-05-16", "2004-05-17", "2004-05-18", "2004-05-19", "2004-05-20", "2004-05-21", "2004-05-22", "2004-05-23", "2004-05-24", "2004-05-25", "2004-05-26", "2004-05-27", "2004-05-28", "2004-05-29", "2004-05-30"],
        "label": "35-44"
      }
    ];

    switch (response) {
      case 'numclicks':
        newData = numclicks;
        break;
      case 'centsspent':
        newData = centsspent;
        break;
      case 'secondsspent':
        newData = secondsspent;
        break;
    }

    this.setState(
      {
        currentResponse: response, dataset: newData
      },
      () => {
        this.refs.line.updateLine();
      });
  }

  updateSegment(segment) {
    console.log('updateSegment called');
    // switch (segment) {
    //   case 'age':
    //     newData = age;
    //     break;
    //   case 'gender':
    //     newData = gender;
    //     break;
    //   case 'country':
    //     newData = country;
    //     break;
    //   case 'language':
    //     newData = language;
    //     break;
    // }
    this.setState(
      {
        dataset: [
          {
            "y": [26.841, 29.5017, 32.6797, 35.8762, 38.4311, 41.5269, 44.947, 47.3607, 50.6523, 53.9446, 56.306, 59.7867, 62.234, 66.0418, 68.4476, 71.5872, 74.0172, 77.5845, 80.2222, 83.7168, 86.3108, 89.5213, 92.7168, 95.2473, 98.7101, 101.0707, 104.7491, 107.7263, 111.0645, 112.6873],
            "x": ["2004-05-01", "2004-05-02", "2004-05-03", "2004-05-04", "2004-05-05", "2004-05-06", "2004-05-07", "2004-05-08", "2004-05-09", "2004-05-10", "2004-05-11", "2004-05-12", "2004-05-13", "2004-05-14", "2004-05-15", "2004-05-16", "2004-05-17", "2004-05-18", "2004-05-19", "2004-05-20", "2004-05-21", "2004-05-22", "2004-05-23", "2004-05-24", "2004-05-25", "2004-05-26", "2004-05-27", "2004-05-28", "2004-05-29", "2004-05-30"],
            "label": "brazil"
          }, {
            "y": [21.9843, 23.1515, 27.8, 29.8872, 32.8504, 35.6338, 38.1679, 41.7197, 44.224, 47.518, 50.5, 53.4733, 56.4179, 59.073, 61.9478, 65.7969, 68.2385, 71.2296, 75.0222, 77.0323, 80.7015, 83.7302, 86.3828, 90.1343, 92.0303, 96.0534, 97.5476, 101.9118, 105.0938, 107.8148],
            "x": ["2004-05-01", "2004-05-02", "2004-05-03", "2004-05-04", "2004-05-05", "2004-05-06", "2004-05-07", "2004-05-08", "2004-05-09", "2004-05-10", "2004-05-11", "2004-05-12", "2004-05-13", "2004-05-14", "2004-05-15", "2004-05-16", "2004-05-17", "2004-05-18", "2004-05-19", "2004-05-20", "2004-05-21", "2004-05-22", "2004-05-23", "2004-05-24", "2004-05-25", "2004-05-26", "2004-05-27", "2004-05-28", "2004-05-29", "2004-05-30"],
            "label": "canada"
          }
        ]
      },
      () => {
        console.log(this.state.dataset);
        this.refs.line.updateLine();
      });
  }

  render() {
    return (<div className='Chart'>
      {/*<Dropdown onClick={(key) => this.handleClick(key)} response={this.state.response} segment={this.state.segment} title='Timeseries' hasSegment={true} />*/}
      <DropdownThree onClick={(key) => this.handleClick(key)} response={this.state.response} segment={this.state.segment} display={this.state.display} title='Timeseries' hasSegment={true} />
      <Line ref='line' width="500px" height="500px" dataset={this.state.dataset} />
    </div>);
  }
}

export default Linechart;